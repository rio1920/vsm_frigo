<!DOCTYPE html>
{% load static %}
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Editar VSM Pendiente</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="{% static 'css/default-colors.css' %}">
  <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet"/>
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
  <style>
    :root {
      --fondo-oscuro: rgb(24, 24, 24);
      --detalle-dorado: rgb(106, 89, 45);
      --bg-secondary: rgb(12, 12, 12);
    }
    body {
      background-color: var(--fondo-oscuro);
      color: white;
    }
  </style>
  <link rel="stylesheet" href="../static/css/default-colors.css">
</head>
<body class="min-h-screen flex items-center justify-center">

  <div class="w-full max-w-xl sm:max-w-2xl md:max-w-3xl bg-[var(--bg-secondary)] rounded-2xl shadow-lg p-8 border border-[var(--detalle-dorado)]">
    <h1 class="text-2xl font-bold text-center mb-6" style="color: var(--detalle-dorado);">
      ‚úèÔ∏è Editar VSM Pendiente
    </h1>

    <form method="POST" class="space-y-6">
      {% csrf_token %}

      <!-- Solicitante -->
      <div>
        <label for="solicitante" class="block mb-2 font-semibold">Solicitante</label>
        <input type="text" id="solicitante" name="solicitante" 
               value="{{ vsm.solicitante }}" 
               class="w-full px-2 py-1 rounded bg-neutral-800 border border-neutral-600 focus:ring-2 focus:ring-yellow-600" required readonly>
      </div>

      <!-- Tipo de Facturaci√≥n -->
      <div>
        <label for="tipo_facturacion" class="block mb-2 font-semibold">Tipo de facturaci√≥n</label>
        <select id="tipo_facturacion" name="tipo_facturacion" 
                class="w-full p-2 rounded bg-neutral-800 border border-neutral-600 focus:ring-2 focus:ring-yellow-600">
          <option value="FACTURADO" {% if vsm.tipo_facturacion == "FACTURADO" %}selected{% endif %}>Facturado</option>
          <option value="NO_FACTURADO" {% if vsm.tipo_facturacion == "NO_FACTURADO" %}selected{% endif %}>No facturado</option>
        </select>
      </div>

      <!-- Centro de Costos -->
      <div>
        <label for="centro_costos" class="block mb-2 font-semibold">Centro de Costos</label>
        <input type="text" id="centro_costos" name="centro_costos" 
               value="{{ vsm.centro_costos.descripcion }}" 
               class="w-full p-2 rounded bg-neutral-800 border border-neutral-600 focus:ring-2 focus:ring-yellow-600" required readonly>
      </div>

      <!-- Retirante -->
      <div>
        <label for="retirante" class="block mb-2 font-semibold">Retirante</label>
        <select id="retirante" name="retirante" 
                class="select2 w-full p-2 rounded bg-neutral-800 border border-neutral-600 focus:ring-2 focus:ring-yellow-600">
          <option value="">Seleccione un retirante</option>
          {% for empleado in empleados %}
            <option value="{{ empleado.id }}" {% if vsm.retirante.id == empleado.id %}selected{% endif %}>
              {{ empleado.nombre }}
            </option>
          {% endfor %}
        </select>
      </div>

      <!-- Observaciones -->
      <div>
        <label for="detalles" class="block mb-2 font-semibold">Observaciones</label>
        <textarea id="detalles" name="detalles" rows="4"
                  class="w-full p-1 rounded bg-neutral-800 border border-neutral-600 focus:ring-2 focus:ring-yellow-600">{{ vsm.observaciones }}</textarea>
      </div>

      <!-- Productos -->
      <div>
        <label class="block mb-2 font-semibold">Productos</label>
        <div class="space-y-4">
          {% for producto in vsm.vsmproducto_set.all %}
            <div class="flex items-center">
              <span class="flex-1">{{ producto.producto.descripcion }}</span>
              <input type="number" name="cantidad_{{ producto.id }}" min="0" value="{{ producto.cantidad_solicitada }}" class="w-24 p-2 rounded bg-neutral-800 border border-neutral-600 focus:ring-2 focus:ring-yellow-600">
            </div>
          {% endfor %}
        </div>
      </div>  

      <!-- Botones -->
      <div class="flex justify-between mt-6">
        <a href="{% url 'registros' %}" 
           class="px-6 py-2 rounded-lg bg-gray-600 hover:bg-gray-500 text-white font-semibold">
          ‚¨Ö Volver
        </a>
        <button type="submit" 
                class="px-6 py-2 rounded-lg bg-yellow-700 hover:bg-yellow-600 font-semibold"
                style="background-color: var(--detalle-dorado);">
          üíæ Guardar cambios
        </button>
      </div>
    </form>
  </div>

</body>
</html>
